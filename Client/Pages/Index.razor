@page "/"
@using BlazorApp.Shared
@inject HttpClient Http

<MudThemeProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudText Typo="Typo.h5" Class="ml-3">Child Timetable</MudText>
        <MudAppBarSpacer />
        <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Default" Edge="Edge.End" Link="https://github.com/MrSimonC" />
    </MudAppBar>
    <MudMainContent>
        <MudPaper>
            <MudContainer MaxWidth="MaxWidth.Small"></MudContainer>
        </MudPaper>
        <MudGrid>
            @if (items == null)
            {
                <p><em>Just hold up there - I'm loading...</em></p>
            }
            else
            {
                @foreach (var item in items)
                {
                    <MudItem xs="3">
                        <MudPaper Class="d-flex align-center justify-center mud-width-full py-8">@item.Name</MudPaper>
                    </MudItem>
                    <MudItem xs="9">
                        <MudPaper Class="d-flex align-center justify-center mud-width-full py-8">@item.Description</MudPaper>
                    </MudItem>
                }
            }
        </MudGrid>
    </MudMainContent>
</MudLayout>

@code {
    private List<TimetableItem>? items;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            items = await Http.GetFromJsonAsync<List<TimetableItem>>("/api/GetEntries");
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.ToString());
        }
    }
}
